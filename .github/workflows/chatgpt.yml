name: ChatGPT API Integration

on:
  push:
    branches:
      - main  # main 브랜치에 변경 사항이 있을 때 실행
  pull_request:
    types: [opened, synchronize]  # PR 생성 또는 업데이트 시 실행

jobs:
  chatgpt:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'

    - name: Install dependencies
      run: |
        pip install openai requests

    - name: Call ChatGPT API
      env:
        OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}  # GitHub Secrets에 API 키 저장 필요
      run: |
        python -c "
import openai
import os

# ChatGPT API 설정
api_key = os.getenv('OPENAI_API_KEY')
openai.api_key = api_key

# 예제 메시지
response = openai.ChatCompletion.create(
    model='gpt-4',
    messages=[
        {'role': 'system', 'content': 'You are an AI developer assistant.'},
        {'role': 'user', 'content': 'Analyze the latest code changes in this GitHub repository.'}
    ]
)

# 응답 출력
print('ChatGPT Response:')
print(response['choices'][0]['message']['content'])
"
